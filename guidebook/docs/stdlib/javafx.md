# JavaFX

JavaFX is a mature, hardware accelerated GUI toolkit for desktop apps. The standard library includes support for:

* Maven based apps that use the OpenJFX dependencies and plugin.
* Apps that use the JavaFX JMODs linked into a JDK.

For Gradle builds, see below.

## JMods version

The following config will cause the JavaFX JMODs to be downloaded and linked in to the runtime.

```hocon
include "/stdlib/jvm/17/openjdk.conf"
include "/stdlib/jvm/javafx/from-jmods.conf" 1️⃣

javafx.version = 16 2️⃣ 

app {
  version = 1.0
  display-name = Demo App
  description = A small demo of what Conveyor can do.

  inputs += "build/install/demoapp/lib/*.jar"

  jvm {
    main-class = hydraulic.demoapp.Demo
    modules += "javafx.{controls,fxml,media,swing,web}"  3️⃣
  }
}
```

1️⃣ Include the JavaFX snippet in the standard library.

2️⃣ Set the version of JavaFX you want to use.

3️⃣ Add the JavaFX modules you want to use. You will need at least `javafx.controls`. Be aware that `javafx.web` bundles a build of WebKit which will significantly increase your download size.

## Maven builds

This is the easiest - just include `/stdlib/jvm/javafx/from-maven.conf`. The config will run Maven to obtain the list of JARs for each supported platform. The native libraries will be pre-extracted during build time and it should all just work. Remember to sync the first line with whatever version and distribution of the JVM you wish to use.

```
include required("/stdlib/jdk/17/openjdk.conf")
include required("/stdlib/jvm/javafx/from-maven.conf")

app {
	....
}
```



## Gradle builds

When using [the JavaFX Gradle plugin from openjfx.io](https://openjfx.io/openjfx-docs/#gradle), you will need to do a bit more work. We'll use config dynamically generated by Gradle itself. [Learn more about this technique here](../configs/maven-gradle.md). Add to your `build.gradle.kts` file (or your Groovy equivalent):

```kotlin
tasks.register("conveyorConfig") {
    // Make sure the app is fully built before we emit any configuration. This bit is optional.
    dependsOn(tasks.getByName("assembleDist"))

    doLast {
        // Sync Conveyor's idea of the app version with Gradle's.
        println("app.version = $version")

        // And the JavaFX version too.
        println("javafx.version = ${javafx.version}")

        // Also sync the JMOD module list.
        for (m in javafx.modules)
            println("app.jvm.modules += $m")

        // Now loop over the JAR of this project, and also all its dependencies.
        for (entry in listOf(tasks.getByName("jar").outputs.files.singleFile) + configurations.runtimeClasspath.get()) {
            // And append the file to the inputs list.
          	
            // But not the JavaFX JARs added by the JavaFX plugin, because those will be for whatever
            // random OS the developer happens to be using today. The Conveyor config will import the
            // JavaFX snippet from the standard library to ensure each platform gets the correct jmods.
            if (entry.name.startsWith("javafx-") && entry.name.endsWith(".jar"))
                continue

            println("app.inputs += \"$entry\"")
        }
    }
}
```

And now add to the bottom of your config:

```
include "#!gradlew -q conveyorConfig"
```
